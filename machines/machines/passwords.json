{
  "machine_id": "MVP_PASSWORDS",
  "version": "1.0.0",
  "entry_state": "START",
  "states": {
    "START": {
      "type": "message",
      "message": "Let’s sort your account access. Are you (1) locked out, (2) forgot password, or (3) seeing an error message? Reply 1/2/3.",
      "next": "CAPTURE_TYPE"
    },
    "CAPTURE_TYPE": {
      "type": "decision",
      "routes": [
        { "match_any": ["1", "locked", "lockout"], "next": "OFFER_RESET" },
        { "match_any": ["2", "forgot", "reset"], "next": "OFFER_RESET" },
        { "match_any": ["3", "error"], "next": "ASK_ERROR" }
      ],
      "default_next": "OFFER_RESET"
    },
    "ASK_ERROR": {
      "type": "message",
      "message": "Copy/paste the exact error message or code you see.",
      "next": "OFFER_RESET"
    },
    "OFFER_RESET": {
      "type": "message",
      "message": "I can reset your password now. Reply YES to confirm, or NO to escalate to second line.",
      "next": "CONSENT_RESET"
    },
    "CONSENT_RESET": {
      "type": "decision",
      "routes": [
        { "match_any": ["yes", "y"], "next": "RESET_STUB" },
        { "match_any": ["no", "n"], "next": "ESCALATE" }
      ],
      "default_next": "ESCALATE"
    },
    "RESET_STUB": {
      "type": "message",
      "message": "Password reset is queued (MVP stub). Please try signing in now and tell me if it worked: YES/NO.",
      "next": "VERIFY"
    },
    "VERIFY": {
      "type": "decision",
      "routes": [
        { "match_any": ["yes", "worked", "fixed", "success"], "next": "RESOLVED" },
        { "match_any": ["no", "still", "failed", "error"], "next": "ESCALATE" }
      ],
      "default_next": "ESCALATE"
    },
    "ESCALATE": {
      "type": "message",
      "message": "I’m escalating this to second line with full context so you don’t have to repeat yourself.",
      "next": "END"
    },
    "RESOLVED": {
      "type": "message",
      "message": "Sorted. You’re back in. I’m closing this now.",
      "next": "END"
    },
    "END": {
      "type": "terminal"
    }
  }
}
